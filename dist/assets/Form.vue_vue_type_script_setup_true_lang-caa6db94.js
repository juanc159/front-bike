import{u as K,V as S}from"./VFileInput-394659a3.js";import{u as T}from"./useCrudUserStore-d2aa6120.js";import{e as A,r as p,g as R,s as j,v as q,Q as u,q as E,o as k,c as P,d as o,w as t,B as d,a as z,E as x,b as c,A as v,k as e,R as M,U,W as N,h as D,j as G}from"./index-5157f066.js";import{V as m}from"./VTextField-f6b14139.js";import{V as L}from"./VSelect-6157aeab.js";import{V as Q}from"./VForm-8fa3c58d.js";const W={class:"col-md-6 d-flex justify-content-end"},_=A({__name:"Form",props:{userId:{type:Number,default:null,required:!1}},setup(C){const w=C,y=p(),I=R(),f=T(),{formulario:s,arrayRoles:F}=j(f),r=p([]),i=p(K()),V=p(!1),g=p([]),b=async n=>{var l;f.typeAction=n,g.value=[],r.value=[],i.value.clearData(),await((l=y.value)==null?void 0:l.resetValidation()),n!="back"&&f.keyList++},$=n=>{i.value.handleImageSelected(n)},B=async()=>{var l;s.value.company_id=I.company.id;const n=await((l=y.value)==null?void 0:l.validate());if(n!=null&&n.valid){i.value.imageFile&&(s.value.photo=i.value.imageFile);const a=await f.fetchSave();a.status===200&&b("list"),a.status===422&&(r.value=a.error)}};return q(s,(n,l)=>{n.id?g.value.password=[]:g.value.password=[u(n.password)]},{deep:!0}),E(async()=>{w.userId&&await f.fetchInfoUser(w.userId)}),(n,l)=>(k(),P("div",null,[o(v,null,{default:t(()=>[o(d,{cols:"12"},{default:t(()=>[z("div",W,[o(x,{color:"secondary",onClick:l[0]||(l[0]=a=>b("back"))},{default:t(()=>[c(" Atras ")]),_:1})])]),_:1})]),_:1}),o(e(Q),{ref_key:"formValidation",ref:y,"lazy-validation":""},{default:t(()=>[o(v,null,{default:t(()=>[o(d,{cols:"12",md:"4"},{default:t(()=>[o(m,{modelValue:e(s).email,"onUpdate:modelValue":l[1]||(l[1]=a=>e(s).email=a),rules:[e(u),e(M)],autocomplete:"off","error-messages":e(r).email,label:"Email",onKeypress:l[2]||(l[2]=a=>e(r).email="")},null,8,["modelValue","rules","error-messages"])]),_:1}),o(d,{cols:"12",md:"4"},{default:t(()=>[o(m,{modelValue:e(s).password,"onUpdate:modelValue":l[3]||(l[3]=a=>e(s).password=a),rules:e(g).password,autocomplete:"off",type:e(V)?"text":"password","append-icon":e(V)?"mdi-eye":"mdi-eye-off","error-messages":e(r).password,label:"Contraseña","onClick:append":l[4]||(l[4]=a=>V.value=!e(V)),onKeypress:l[5]||(l[5]=a=>e(r).password="")},null,8,["modelValue","rules","type","append-icon","error-messages"])]),_:1}),o(d,{cols:"12",md:"4"},{default:t(()=>[o(m,{modelValue:e(s).name,"onUpdate:modelValue":l[6]||(l[6]=a=>e(s).name=a),rules:[e(u)],"error-messages":e(r).name,label:"Nombre",onKeypress:l[7]||(l[7]=a=>e(r).name="")},null,8,["modelValue","rules","error-messages"])]),_:1}),o(d,{cols:"12",md:"4"},{default:t(()=>[o(m,{modelValue:e(s).lastName,"onUpdate:modelValue":l[8]||(l[8]=a=>e(s).lastName=a),rules:[e(u)],"error-messages":e(r).lastName,label:"Apellido",onKeypress:l[9]||(l[9]=a=>e(r).lastName="")},null,8,["modelValue","rules","error-messages"])]),_:1}),o(d,{cols:"12",md:"4"},{default:t(()=>[o(L,{modelValue:e(s).role_id,"onUpdate:modelValue":[l[10]||(l[10]=a=>e(s).role_id=a),l[11]||(l[11]=a=>e(r).role_id="")],rules:[e(u)],items:e(F),"item-title":"name","item-value":"id",label:"Tipo de usuario","error-messages":e(r).role_id},null,8,["modelValue","rules","items","error-messages"])]),_:1}),o(d,{cols:"12",md:"4"},{default:t(()=>[o(m,{modelValue:e(s).identification,"onUpdate:modelValue":l[12]||(l[12]=a=>e(s).identification=a),maxlength:"10",rules:[e(u),e(U)(e(s).identification,10)],"error-messages":e(r).identification,label:"identificación",onKeypress:l[13]||(l[13]=a=>{e(r).identification="",e(N)(a)})},null,8,["modelValue","rules","error-messages"])]),_:1})]),_:1}),o(v,null,{default:t(()=>[o(d,{cols:"12",md:"4"},{default:t(()=>[o(m,{modelValue:e(s).phone,"onUpdate:modelValue":l[14]||(l[14]=a=>e(s).phone=a),maxlength:"15",rules:[e(u),e(U)(e(s).phone,15)],"error-messages":e(r).phone,label:"Telefono",onKeypress:l[15]||(l[15]=a=>{e(r).phone="",e(N)(a)})},null,8,["modelValue","rules","error-messages"])]),_:1}),o(d,{cols:"12",md:"4"},{default:t(()=>[(k(),D(S,{key:e(i).key,"show-size":"",counter:"",label:"Photo",accept:"image/*",onChange:l[16]||(l[16]=a=>$(a))},{default:t(()=>[c(" /> ")]),_:1}))]),_:1}),o(d,{cols:"12"},{default:t(()=>[o(G,{contain:"",src:e(i).imageUrl??e(s).photo,alt:"foto Personal","max-width":200,class:"mx-auto"},null,8,["src"])]),_:1})]),_:1}),o(v,null,{default:t(()=>[o(d,{cols:"12 d-flex justify-content-center"},{default:t(()=>[o(x,{color:"primary",onClick:B},{default:t(()=>[c(" Guardar ")]),_:1})]),_:1})]),_:1})]),_:1},512)]))}});export{_};
