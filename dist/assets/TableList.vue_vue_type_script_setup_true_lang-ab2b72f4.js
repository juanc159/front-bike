import{d as M,z as Q,j as q,y as G,k,ar as H,G as B,bj as K,I as J,o as _,c as g,p as l,w as i,m as e,q as n,H as x,V as h,E as D,K as v,L as V,F as P,a as O,x as u,A as $}from"./index-ecce922e.js";import{n as T}from"./validators-da167dd6.js";import{_ as W,V as X}from"./VPagination-b0fd92c0.js";import{u as Y}from"./useCrudCompanyStore-b4809b15.js";import{S as Z}from"./sweetalert2.all-09c1f25c.js";import{V as ee}from"./VSelect-d4be5138.js";import{V as ae}from"./VSpacer-07cad1f4.js";import{V as te}from"./VTextField-a151c4b5.js";import{V as N}from"./VContainer-c4cd337c.js";import{V as z}from"./VDivider-32b31792.js";import{V as le}from"./VSwitch-e3487ccb.js";import{V as se}from"./VTable-1a3fdd4b.js";const oe={class:"me-3",style:{width:"80px"}},ne={class:"app-user-search-filter d-flex align-center flex-wrap gap-4"},re={style:{width:"10rem"}},ie=e("thead",null,[e("tr",null,[e("th",{scope:"col"}," Empresa "),e("th",{scope:"col"}," Nit "),e("th",{scope:"col"}," Plan "),e("th",{scope:"col"}," Nombre representante "),e("th",{scope:"col"}," Teléfono representante "),e("th",{scope:"col"}," Base "),e("th",{scope:"col"}," Estado "),e("th",{scope:"col"}," Acciones ")])],-1),ce={colspan:"8"},ue=e("td",null,[e("span",null," Plan ")],-1),de={class:"text-center",style:{width:"5rem"}},pe=e("tr",null,[e("td",{colspan:"8",class:"text-center"}," No se encuentran resultados ")],-1),me=[pe],fe={class:"text-sm text-disabled"},De=M({__name:"TableList",setup(he){const r=Y(),w=Q(),A=q(),{currentPage:s,totalPage:m,lastPage:U,totalData:I,companies:f,loading:C,formulario:S}=G(r),c=k(10),d=k(""),y=async()=>{await r.fetchAll({user_id:w.user.id,perPage:c.value,page:s.value,searchQuery:d.value})};H(async()=>{await y()}),B(s,async()=>{s.value>m.value&&(s.value=m.value)}),B(c,async()=>{s.value=1}),K([s,d,c],async()=>{await y()});const L=J(()=>{const o=f.value.length?(s.value-1)*m.value+1:0,t=f.value.length+(s.value-1)*m.value;return`Mostrando ${o} a ${t} de ${I.value} registros`}),b=async(o,t)=>{r.clearFormulario(),r.typeAction=o,t&&(await r.fetchInfoCompany(t),S.value.base=T(S.value.base))},R=o=>{w.company=o,A.push({name:"index"})},E=async(o,t)=>{r.changeState(o,t)},F=async o=>{Z.fire({title:"¿Desea eliminar el registro?",showDenyButton:!0,showCancelButton:!1,confirmButtonText:"Si",denyButtonText:"No"}).then(async t=>{t.isConfirmed?(await r.fetchDelete(o),await y()):t.isDenied})};return(o,t)=>(_(),g(P,null,[l(N,{fluid:"",class:"d-flex flex-wrap py-4 gap-4"},{default:i(()=>[e("div",oe,[l(ee,{modelValue:n(c),"onUpdate:modelValue":t[0]||(t[0]=a=>x(c)?c.value=a:null),density:"compact",variant:"outlined",items:[10,20,30,50]},null,8,["modelValue"])]),l(ae),e("div",ne,[e("div",re,[l(te,{modelValue:n(d),"onUpdate:modelValue":t[1]||(t[1]=a=>x(d)?d.value=a:null),placeholder:"Buscar",density:"compact"},null,8,["modelValue"])]),l(h,{color:"primary",onClick:t[2]||(t[2]=a=>b("form"))},{default:i(()=>[D(" Crear empresa ")]),_:1})])]),_:1}),l(z),l(se,{class:"text-no-wrap"},{default:i(()=>[ie,e("tbody",null,[v(e("tr",null,[e("td",ce,[l(W)])],512),[[V,n(C)]]),(_(!0),g(P,null,O(n(f),(a,j)=>v((_(),g("tr",{key:j,style:{height:"3.75rem"}},[e("td",null,[e("span",null,u(a.name),1)]),e("td",null,[e("span",null,u(a.nit),1)]),ue,e("td",null,[e("span",null,u(a.nameLegalRepresentative),1)]),e("td",null,[e("span",null,u(a.phoneLegalRepresentative),1)]),e("td",null,[e("span",null,u(n(T)(a.base)),1)]),e("td",null,[l(le,{modelValue:a.state,"onUpdate:modelValue":p=>a.state=p,color:"success",inset:"",value:a.state,"true-value":1,"false-value":0,"hide-details":"",onClick:p=>E(a,a.state)},null,8,["modelValue","onUpdate:modelValue","value","onClick"])]),e("td",de,[l(h,{icon:"",size:"x-small",color:"error",variant:"text",onClick:p=>F(a.id)},{default:i(()=>[l($,{size:"22",icon:"tabler-trash"})]),_:2},1032,["onClick"]),l(h,{icon:"",size:"x-small",color:"default",variant:"text",onClick:p=>b("form",a.id)},{default:i(()=>[l($,{size:"22",icon:"tabler-edit"})]),_:2},1032,["onClick"]),v(l(h,{color:"primary",onClick:p=>R(a)},{default:i(()=>[D(" Ingresar ")]),_:2},1032,["onClick"]),[[V,a.state===1]])])])),[[V,!n(C)]])),128))]),v(e("tfoot",null,me,512),[[V,!n(f).length]])]),_:1}),l(z),l(N,{fluid:"",class:"d-flex align-center flex-wrap justify-space-between gap-4 py-3 px-5"},{default:i(()=>[e("span",fe,u(n(L)),1),l(X,{modelValue:n(s),"onUpdate:modelValue":t[3]||(t[3]=a=>x(s)?s.value=a:null),size:"small","total-visible":5,length:n(U)},null,8,["modelValue","length"])]),_:1})],64))}});export{De as _};
